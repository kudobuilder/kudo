# This test verifies that the InstanceController triggers the right plan
# executions when upgrading an instance.
#
# In order to do so, it creates a simple Operator, its corresponding
# OperationVersion and a few instances.
#
# The next step will then create new OperatorVersions which will only differ in
# their names and the plans. The instances will then be upgraded to those plans
# and we'll verify that the right PlanExecutions are created.
apiVersion: kudo.k8s.io/v1alpha1
kind: Operator
metadata:
  name: icto-upgrade
---
apiVersion: kudo.k8s.io/v1alpha1
kind: OperatorVersion
metadata:
  name: icto-upgrade
spec:
  operator:
    name: icto-upgrade
    kind: Operator
  version: "1.0"
  plans:
    deploy:
    upgrade:
---
apiVersion: kudo.k8s.io/v1alpha1
kind: Instance
metadata:
  name: icto-upgrade
  labels:
    operator: icto-upgrade
spec:
  operatorVersion:
    name: icto-upgrade
    kind: OperatorVersion
---
apiVersion: kudo.k8s.io/v1alpha1
kind: Instance
metadata:
  name: icto-upgrade-fallback-to-update
  labels:
    operator: icto-upgrade
spec:
  operatorVersion:
    name: icto-upgrade
    kind: OperatorVersion
---
apiVersion: kudo.k8s.io/v1alpha1
kind: Instance
metadata:
  name: icto-upgrade-fallback-to-deploy
  labels:
    operator: icto-upgrade
spec:
  operatorVersion:
    name: icto-upgrade
    kind: OperatorVersion
