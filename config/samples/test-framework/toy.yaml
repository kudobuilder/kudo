apiVersion: kudo.k8s.io/v1alpha1
kind: Framework
metadata:
  labels:
    controller-tools.k8s.io: "1.0"
  name: toy
---
apiVersion: kudo.k8s.io/v1alpha1
kind: FrameworkVersion
metadata:
  labels:
    controller-tools.k8s.io: "1.0"
  name: toy-v1
  namespace: default
spec:
  version: "1.0.0"
  connectionString: ""
  framework:
    name: toy
    kind: Framework
  templates:
    deployment.yaml: |
      apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2
      kind: Deployment
      metadata:
        name: nginx-deployment
      spec:
        selector:
          matchLabels:
            app: nginx
        replicas: {{ .Params.Replicas }} # tells deployment to run 2 pods matching the template
        template:
          metadata:
            labels:
              app: nginx
          spec:
            containers:
            - name: nginx
              image: nginx:1.7.9
              env:
              - name: ENVIRONMENT_VARIABLE
                value: "{{ .Params.Param }}"
              ports:
              - containerPort: 80
  tasks:
    deploy:
      resources:
      - deployment.yaml
  parameters:
  - name: Param
    description: "Sample parameter"
    default: "before"
  - name: Replicas
    description: "Sample parameter"
    default: "1"
    trigger: scale
  plans:
    deploy:
      strategy: serial
      phases:
        - name: deploy
          steps:
            - name: deploy
              tasks:
              - deploy
    update:
      strategy: serial
      phases:
        - name: update
          steps:
            - name: update
              tasks:
              - deploy
    scale:
      strategy: serial
      phases:
        - name: scale
          steps:
            - name: scale
              tasks:
              - deploy



